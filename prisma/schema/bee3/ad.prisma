enum AdTiers {
    Free
    Pro
    Expert
}

model Category {
    path             String     @id
    parentCategory   Category?  @relation("CategoryToCategory", fields: [parentCategoryId], references: [path], onDelete: NoAction, onUpdate: NoAction)
    parentCategoryId String?
    productCategory  Category[] @relation("CategoryToCategory")

    name        String  @unique
    description String? @db.Text
    depth       Int
    Ads         Ad[]
}

model Ad {
    id           String   @id @default(cuid())
    userId       String?
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
    user         User?    @relation(fields: [userId], references: [id])
    category     Category @relation(fields: [categoryPath], references: [path])
    categoryPath String

    tier        AdTiers  @default(Free)
    title       String
    description String?  @db.Text
    images      String[]
    price       Float
    negotiable  Boolean

    analytics     AdAnalytics @relation(fields: [adAnalyticsId], references: [id])
    adAnalyticsId String
}

model AdTokenStore {
    id     String @id @default(cuid())
    userId String
    user   User   @relation(fields: [userId], references: [id])

    tokenType       AdTiers
    initialCount    Int
    count           Int
    nextRefreshTime DateTime
    refreshInDays   Int

    @@unique([userId, tokenType])
}

model AdAnalytics {
    id String @id @default(cuid())
    Ad Ad[]

    views       Int
    uniqueViews Int
}
